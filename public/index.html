<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="manifest" href="manifest.json"/>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-F8D142ZGBQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-F8D142ZGBQ');
  </script>
</head>

<body bgcolor="#FFFFFF" text="#000000">
  <ul>
    <li><a href="google-maps/index.html">Google Maps</a></li>
    <li><a href="mapbox/index.html">Mapbox</a></li>
    <li><a href="sign/index.html">Browser Sign</a></li>
  </ul>
  <hr />
  <ul>
    <li><a href="api-doc/swagger/">API DOC Swagger</a></li>
  </ul>
  <hr />
  <ul>
    <li><a href="https://file.dgkim.net/procexp.exe">Process Explorer</a></li>
    <li><a href="https://file.dgkim.net/Tcpview.exe">TCPView</a></li>
    <li><a href="https://file.dgkim.net/HangulPuTTY-0.58.h2.exe">한글 Putty 0.58.h2</a></li>
    <li><a href="https://file.dgkim.net/gvim73_46.exe">GVIM 7.3</a></li>
    <li><a href="https://file.dgkim.net/gvim72.exe">GVIM 7.2</a></li>
    <li><a href="https://file.dgkim.net/vim72.zip">GVIM 7.2 for Windows 64bit(수동설치 - 설치할 경로에 풀고 vim72/install.exe 실행)</a></li>
    <li><a href="https://file.dgkim.net/unzip.exe">unzip.exe</a></li>
    <li><a href="https://file.dgkim.net/openvpn-2.0.9-gui-1.0.3-install.exe">openvpn gui</a></li>
    <li><a href="https://file.dgkim.net/Fiddler2Setup.exe">Fiddler2</a></li>
  </ul>
  <ul>
    <li><a href="https://file.dgkim.net/Videos/%EC%9D%BC%EC%83%81%EC%A0%90%EA%B2%80/Video-2018-09-21-16-13-16_2205-masked.mp4">일상점검 2.2 Video</a></a></li>
    <li><a href="https://file.dgkim.net/Videos/%EC%9D%BC%EC%83%81%EC%A0%90%EA%B2%80/IMG_0107-masked.mp4">일상점검 2.8 Video</a></a></li>
  </ul>
  <ul>
    <li><a href="Pandion _ Plug-Ins.htm">Pandion _ Plug-Ins</a></a></li>
  </ul>
  <hr />
  <label>username</label>
  <input name="username" value=""/>
  <input type="submit" />
  <script type="text/javascript">
    document.querySelector('input[type=submit]').addEventListener('click', () => {
      const username = document.querySelector('input[name=username]').value;
      console.log('clicked');
      localStorage.setItem('username', username);
      Notification.requestPermission().then((permission) => {
        if (permission !== "granted") {
          // 푸시 거부됐을 때 처리할 내용
          alert('push requested')
        } else {
          // 푸시 승인됐을 때 처리할 내용
          alert('push not granted');
        }
      });
    });
    document.querySelector('input[name=username]').value = localStorage.getItem('username');
  </script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-analytics.js";
    import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-messaging.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyAE2VdG2Cy9FazviYV2cAK3jXBVuC-wl54",
      authDomain: "public-dgkim-net.firebaseapp.com",
      projectId: "public-dgkim-net",
      storageBucket: "public-dgkim-net.appspot.com",
      messagingSenderId: "146213314861",
      appId: "1:146213314861:web:d27b37bf3b4a22d9c133a4",
      measurementId: "G-27P1NDX90N"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const messaging = getMessaging(app);

    // Add the public key generated from the console here.
    getToken(messaging, { vapidKey: "BOxvbl4f6mMCIgEkmITsHODNUjxJIwdmDvjIaSiCSvDtssGNS9moI3hRNxpPNTY6OfgcJW0LNYPr2HVilEoWLJ0" }).then((currentToken) => {
      if (currentToken) {
        // Send the token to your server and update the UI if necessary
        console.log('GotToken', currentToken);
        fetch('https://public-api.dgkim.net/v1/fcm-tokens', {
          method: 'POST',
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            datetime: new Date().toISOString(),
            fcmToken: currentToken,
            username: localStorage.getItem('username')
          })
        }).then((response) => {
          console.log(response);
        })
      } else {
        // Show permission request UI
        console.log('No registration token available. Request permission to generate one.');
        // ...
      }
    }).catch((err) => {
      console.log('An error occurred while retrieving token. ', err);
      // ...
    });;

    console.log("Firebase initialized");
  </script>
</body>
</html>
